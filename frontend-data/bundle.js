(function (d3, topojson) {
  'use strict';

  // Started code Laurens Aarnoudse

  // const endpointRate = 'https://opendata.rdw.nl/resource/534e-5vdg.json'
  const endpointGeoPoints = 'https://opendata.rdw.nl/resource/nsk3-v9n7.json';
  const colomnName = 'areageometryastext';

  getData(endpointGeoPoints)
  	.then(parkingDataResponse => {
    	return parkingDataResponse.json()
  })
  .then(parkingData => {
   		// console.log(parkingData)
  		const geoPointsArray = filterData(parkingData, colomnName);
  		// console.log(geoPointsArray)
      
      const svg = d3.select('svg');

  const projection = d3.geoMercator().scale(5000).center([5.116667,52.17000]);
  const pathGenerator = d3.geoPath().projection(projection);

  d3.json('https://cartomap.github.io/nl/wgs84/gemeente_2020.topojson').then(data => {
  	const gemeentes = topojson.feature(data, data.objects.gemeente_2020);
    
    svg.selectAll('path').data(gemeentes.features)
    	.enter().append('path')
    		.attr('d', pathGenerator)
  		.append('title')
    		.text(d => `${d.properties.statnaam}, ID:${d.id}`);
    
    //source https://www.youtube.com/watch?v=hrJ64jpYb0A
    const carParks = svg.selectAll('g')
    	.data(geoPointsArray)
    	// .join('g')
    	.enter().append('g');
    
    const carParking = carParks.append('g')
    	.attr('transform', ({ longitude, latitude }) => `translate(${projection([longitude, latitude]).join(",")})`);
    
    carParking.append('circle')
    		.attr('r', '2');
  });
  });

  function getData(url){
    return fetch(url)
  }

  // With help of Laurens Aarnoudse
  function filterData(dataArray, key){
    return dataArray.map(item => {
      const geoPoints = item[key]
      .replace(' ', '')
      .replace(',', '')
      .replace('))', '')
      .replace('((', '')
      .replace(')', '')
      .replace('(', '')
      .replace('GEOMETRYCOLLECTIONLINESTRING', '')
      .replace('MULTIPOLYGON', '') 
      .replace('POINT', '')
      .replace('POLYGON', '')
      .replace('(', '')
      .replace(')', '')
  		.slice(0, 24);
      const geoArray = geoPoints.split(' ');
  		return { longitude: geoArray[1], latitude: geoArray[0] }
    	}
    )
  }

  // function calcParkingRate(AmountFarePart, stepSizeFarePart) {
  // 	return AmountFarePart / stepSizeFarePart
  // }

}(d3, topojson));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFN0YXJ0ZWQgY29kZSBMYXVyZW5zIEFhcm5vdWRzZVxuaW1wb3J0IHsgc2VsZWN0LCBqc29uLCBnZW9QYXRoLCBnZW9NZXJjYXRvciwgem9vbSB9IGZyb20gJ2QzJ1xuaW1wb3J0IHsgZmVhdHVyZSB9IGZyb20gJ3RvcG9qc29uJ1xuXG4vLyBjb25zdCBlbmRwb2ludFJhdGUgPSAnaHR0cHM6Ly9vcGVuZGF0YS5yZHcubmwvcmVzb3VyY2UvNTM0ZS01dmRnLmpzb24nXG5jb25zdCBlbmRwb2ludEdlb1BvaW50cyA9ICdodHRwczovL29wZW5kYXRhLnJkdy5ubC9yZXNvdXJjZS9uc2szLXY5bjcuanNvbidcbmNvbnN0IGNvbG9tbk5hbWUgPSAnYXJlYWdlb21ldHJ5YXN0ZXh0J1xuXG5nZXREYXRhKGVuZHBvaW50R2VvUG9pbnRzKVxuXHQudGhlbihwYXJraW5nRGF0YVJlc3BvbnNlID0+IHtcbiAgXHRyZXR1cm4gcGFya2luZ0RhdGFSZXNwb25zZS5qc29uKClcbn0pXG4udGhlbihwYXJraW5nRGF0YSA9PiB7XG4gXHRcdC8vIGNvbnNvbGUubG9nKHBhcmtpbmdEYXRhKVxuXHRcdGNvbnN0IGdlb1BvaW50c0FycmF5ID0gZmlsdGVyRGF0YShwYXJraW5nRGF0YSwgY29sb21uTmFtZSlcblx0XHQvLyBjb25zb2xlLmxvZyhnZW9Qb2ludHNBcnJheSlcbiAgICBcbiAgICBjb25zdCBzdmcgPSBzZWxlY3QoJ3N2ZycpXG5cbmNvbnN0IHByb2plY3Rpb24gPSBnZW9NZXJjYXRvcigpLnNjYWxlKDUwMDApLmNlbnRlcihbNS4xMTY2NjcsNTIuMTcwMDBdKVxuY29uc3QgcGF0aEdlbmVyYXRvciA9IGdlb1BhdGgoKS5wcm9qZWN0aW9uKHByb2plY3Rpb24pXG5cbmpzb24oJ2h0dHBzOi8vY2FydG9tYXAuZ2l0aHViLmlvL25sL3dnczg0L2dlbWVlbnRlXzIwMjAudG9wb2pzb24nKS50aGVuKGRhdGEgPT4ge1xuXHRjb25zdCBnZW1lZW50ZXMgPSBmZWF0dXJlKGRhdGEsIGRhdGEub2JqZWN0cy5nZW1lZW50ZV8yMDIwKVxuICBcbiAgc3ZnLnNlbGVjdEFsbCgncGF0aCcpLmRhdGEoZ2VtZWVudGVzLmZlYXR1cmVzKVxuICBcdC5lbnRlcigpLmFwcGVuZCgncGF0aCcpXG4gIFx0XHQuYXR0cignZCcsIHBhdGhHZW5lcmF0b3IpXG5cdFx0LmFwcGVuZCgndGl0bGUnKVxuICBcdFx0LnRleHQoZCA9PiBgJHtkLnByb3BlcnRpZXMuc3RhdG5hYW19LCBJRDoke2QuaWR9YClcbiAgXG4gIC8vc291cmNlIGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9aHJKNjRqcFliMEFcbiAgY29uc3QgY2FyUGFya3MgPSBzdmcuc2VsZWN0QWxsKCdnJylcbiAgXHQuZGF0YShnZW9Qb2ludHNBcnJheSlcbiAgXHQvLyAuam9pbignZycpXG4gIFx0LmVudGVyKCkuYXBwZW5kKCdnJylcbiAgXG4gIGNvbnN0IGNhclBhcmtpbmcgPSBjYXJQYXJrcy5hcHBlbmQoJ2cnKVxuICBcdC5hdHRyKCd0cmFuc2Zvcm0nLCAoeyBsb25naXR1ZGUsIGxhdGl0dWRlIH0pID0+IGB0cmFuc2xhdGUoJHtwcm9qZWN0aW9uKFtsb25naXR1ZGUsIGxhdGl0dWRlXSkuam9pbihcIixcIil9KWApXG4gIFxuICBjYXJQYXJraW5nLmFwcGVuZCgnY2lyY2xlJylcbiAgXHRcdC5hdHRyKCdyJywgJzInKTtcbn0pXG59KVxuXG5mdW5jdGlvbiBnZXREYXRhKHVybCl7XG4gIHJldHVybiBmZXRjaCh1cmwpXG59XG5cbi8vIFdpdGggaGVscCBvZiBMYXVyZW5zIEFhcm5vdWRzZVxuZnVuY3Rpb24gZmlsdGVyRGF0YShkYXRhQXJyYXksIGtleSl7XG4gIHJldHVybiBkYXRhQXJyYXkubWFwKGl0ZW0gPT4ge1xuICAgIGNvbnN0IGdlb1BvaW50cyA9IGl0ZW1ba2V5XVxuICAgIC5yZXBsYWNlKCcgJywgJycpXG4gICAgLnJlcGxhY2UoJywnLCAnJylcbiAgICAucmVwbGFjZSgnKSknLCAnJylcbiAgICAucmVwbGFjZSgnKCgnLCAnJylcbiAgICAucmVwbGFjZSgnKScsICcnKVxuICAgIC5yZXBsYWNlKCcoJywgJycpXG4gICAgLnJlcGxhY2UoJ0dFT01FVFJZQ09MTEVDVElPTkxJTkVTVFJJTkcnLCAnJylcbiAgICAucmVwbGFjZSgnTVVMVElQT0xZR09OJywgJycpIFxuICAgIC5yZXBsYWNlKCdQT0lOVCcsICcnKVxuICAgIC5yZXBsYWNlKCdQT0xZR09OJywgJycpXG4gICAgLnJlcGxhY2UoJygnLCAnJylcbiAgICAucmVwbGFjZSgnKScsICcnKVxuXHRcdC5zbGljZSgwLCAyNClcbiAgICBjb25zdCBnZW9BcnJheSA9IGdlb1BvaW50cy5zcGxpdCgnICcpXG5cdFx0cmV0dXJuIHsgbG9uZ2l0dWRlOiBnZW9BcnJheVsxXSwgbGF0aXR1ZGU6IGdlb0FycmF5WzBdIH1cbiAgXHR9XG4gIClcbn1cblxuLy8gZnVuY3Rpb24gY2FsY1BhcmtpbmdSYXRlKEFtb3VudEZhcmVQYXJ0LCBzdGVwU2l6ZUZhcmVQYXJ0KSB7XG4vLyBcdHJldHVybiBBbW91bnRGYXJlUGFydCAvIHN0ZXBTaXplRmFyZVBhcnRcbi8vIH0iXSwibmFtZXMiOlsic2VsZWN0IiwiZ2VvTWVyY2F0b3IiLCJnZW9QYXRoIiwianNvbiIsImZlYXR1cmUiXSwibWFwcGluZ3MiOiI7OztFQUFBO0FBR0E7RUFDQTtFQUNBLE1BQU0saUJBQWlCLEdBQUcsa0RBQWlEO0VBQzNFLE1BQU0sVUFBVSxHQUFHLHFCQUFvQjtBQUN2QztFQUNBLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQztFQUMxQixFQUFFLElBQUksQ0FBQyxtQkFBbUIsSUFBSTtFQUM5QixHQUFHLE9BQU8sbUJBQW1CLENBQUMsSUFBSSxFQUFFO0VBQ3BDLENBQUMsQ0FBQztFQUNGLENBQUMsSUFBSSxDQUFDLFdBQVcsSUFBSTtFQUNyQjtFQUNBLEVBQUUsTUFBTSxjQUFjLEdBQUcsVUFBVSxDQUFDLFdB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